function update(){Array.from(document.getElementsByClassName("draggable")).forEach(function(e){var t=0,n=0,o=0,d=0;function l(l){(l=l||window.event).preventDefault(),t=o-l.clientX,n=d-l.clientY,o=l.clientX,d=l.clientY;var c=e.offsetTop-n,a=e.offsetLeft-t,i=e.childNodes[3].getBoundingClientRect().right,s=e.childNodes[3].getBoundingClientRect().bottom;c>150&&a>0&&i+3<(window.innerWidth||document.documentElement.clientWidth)&&s<(window.innerHeight||document.documentElement.clientHeight)-6?(e.style.top=c+"px",e.style.left=a+"px"):i+3>=(window.innerWidth||document.documentElement.clientWidth)?e.style.left=e.offsetLeft-1+"px":s>=(window.innerHeight||document.documentElement.clientHeight)-6&&(e.style.top=e.offsetTop-1+"px")}function c(){document.onmouseup=null,document.onmousemove=null}e.childNodes[1].onmousedown=function(e){(e=e||window.event).preventDefault(),o=e.clientX,d=e.clientY,document.onmouseup=c,document.onmousemove=l}})}function postItSyncEle(e,t){var n=e.id,o=e.getBoundingClientRect().top,d=e.getBoundingClientRect().left,l=e.childNodes[3].getBoundingClientRect().width,c=e.childNodes[3].getBoundingClientRect().height,a=e.childNodes[3].style.backgroundColor,i=e.style.zIndex,s=e.childNodes[3].value,r=document.cookie,m=e.childNodes[1].childNodes[7].innerHTML;return json={id:n,top:o,left:d,width:l,height:c,color:a,zIndex:i,content:s,cookie:r,author:m,send_type:t},json}function deletePostIt(e){e.remove()}function changeColor(e){color=e.innerHTML,elmnt=e.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement,text_area=elmnt.childNodes[3],elmnt.style.backgroundColor=color,text_area.style.backgroundColor=color}function showDropdownColor(e){e.parentElement.classList.toggle("showcolor")}function showDropdownGround(e){e.parentElement.classList.toggle("showground")}function indexUp(e){elmnt=e.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement,zIndex=parseInt(elmnt.style.zIndex),newZIndex=zIndex+1,elmnt.style.zIndex=newZIndex.toString()}function indexDown(e){elmnt=e.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement,elmnt.style.zIndex-=1}update(),$(function(){window.location.protocol;const e=JSON.parse(document.getElementById("session").textContent);var t=new ReconnectingWebSocket("ws://"+window.location.host+"/ws/IdeaPost/"+e+"/"),n={};function o(){$(".textarea").bind("input propertychange",function(e){var n=postItSyncEle(e.target.parentElement,"write");return t.send(JSON.stringify(n)),!1})}function d(e){var t=0;$(".draggable").each(function(){t=Math.max(this.id,t)});var n=document.createElement("div"),d=document.createElement("div"),l=document.createElement("h3"),c=document.createTextNode(e),a=document.createElement("textarea"),i=document.createElement("img"),s=document.createElement("div"),r=document.createElement("img"),m=document.createElement("ul"),p=document.createElement("li"),u=document.createElement("li"),h=document.createElement("li"),g=document.createElement("button"),E=document.createElement("div"),C=document.createElement("button"),N=document.createElement("ul"),w=document.createElement("li"),f=document.createElement("li"),y=document.createElement("li"),b=document.createElement("li"),x=document.createElement("li"),v=document.createElement("li"),k=document.createElement("li"),T=document.createElement("button"),I=document.createElement("button"),L=document.createElement("button"),B=document.createElement("button"),A=document.createElement("button"),H=document.createElement("button"),M=document.createElement("button"),S=document.createElement("div"),D=document.createElement("button"),_=document.createElement("ul"),z=document.createElement("li"),O=document.createElement("li"),J=document.createElement("button"),R=document.createElement("button"),P=document.createElement("br"),U=document.createTextNode(""),W=document.createTextNode(""),X=document.createTextNode(""),G=document.createTextNode(""),Y=document.createTextNode(""),j=document.createTextNode(""),Z=document.createTextNode(""),V=document.createTextNode(""),q=document.createTextNode(""),F=document.createTextNode(""),K=document.createTextNode(""),Q=document.createTextNode(""),ee=document.createTextNode(""),te=document.createTextNode(""),ne=document.createTextNode(""),oe=document.createTextNode(""),de=document.createTextNode(""),le=document.createTextNode("");return n.className="draggable",n.id=t+1,n.style.zIndex=0,n.style.backgroundColor="lightblue",n.style.top="150px",d.className="author",a.className="textarea",a.style.backgroundColor="lightblue",i.className="thumbtacks",i.src=thumbtackUrl,r.src=optionsUrl,s.className="dropdown",s.addEventListener("click",function(e){var t=(e=e||window.event).target;t.textContent||t.innerText;t.parentElement.classList.toggle("show")}),g.className="listbutton deleteButton",g.innerHTML="Delete",T.className="listbutton",T.setAttribute("onClick","changeColor(this)"),T.innerHTML="lightblue",I.className="listbutton",I.setAttribute("onClick","changeColor(this)"),I.innerHTML="pink",L.className="listbutton",L.setAttribute("onClick","changeColor(this)"),L.innerHTML="yellow",B.className="listbutton",B.setAttribute("onClick","changeColor(this)"),B.innerHTML="lightgreen",A.className="listbutton",A.setAttribute("onClick","changeColor(this)"),A.innerHTML="orange",H.className="listbutton",H.setAttribute("onClick","changeColor(this)"),H.innerHTML="purple",M.className="listbutton",M.setAttribute("onClick","changeColor(this)"),M.innerHTML="olive",w.appendChild(T),f.appendChild(I),y.appendChild(L),b.appendChild(B),x.appendChild(A),v.appendChild(H),k.appendChild(M),E.className="dropdowncolor",C.className="listbutton",C.innerHTML="Color >",C.setAttribute("onClick","showDropdownColor(this)"),J.className="listbutton",J.setAttribute("onClick","indexUp(this)"),J.innerHTML="Up +",R.className="listbutton",R.setAttribute("onClick","indexDown(this)"),R.innerHTML="Down -",z.appendChild(J),O.appendChild(R),S.className="dropdownground",D.className="listbutton",D.innerHTML="Ground >",D.setAttribute("onClick","showDropdownGround(this)"),l.appendChild(c),E.appendChild(K),E.appendChild(C),E.appendChild(Q),N.appendChild(w),N.appendChild(f),N.appendChild(y),N.appendChild(b),N.appendChild(x),N.appendChild(v),N.appendChild(k),E.appendChild(N),E.appendChild(ee),S.appendChild(D),_.appendChild(z),_.appendChild(O),S.appendChild(_),p.appendChild(g),u.appendChild(E),u.appendChild(F),h.appendChild(S),s.appendChild(r),s.appendChild(G),m.appendChild(j),m.appendChild(p),m.appendChild(Z),m.appendChild(u),m.appendChild(V),m.appendChild(h),m.appendChild(q),s.appendChild(m),s.appendChild(Y),d.appendChild(te),d.appendChild(i),d.appendChild(ne),d.appendChild(s),d.appendChild(oe),d.appendChild(P),d.appendChild(de),d.appendChild(l),d.appendChild(le),n.appendChild(U),n.appendChild(d),n.appendChild(W),n.appendChild(a),n.appendChild(X),document.body.appendChild(n),update(),o(),n}t.onclose=function(e){console.error(e)},t.onmessage=function(e){var t=JSON.parse(e.data);console.log(t),"write"==t.send_type?t.cookie!=document.cookie&&(document.getElementById(t.id).childNodes[3].value=t.content):"move"==t.send_type?t.cookie!=document.cookie&&(document.getElementById(t.id).style.top=t.top+"px",document.getElementById(t.id).style.left=t.left+"px",document.getElementById(t.id).style.backgroundColor=t.color,document.getElementById(t.id).childNodes[3].style.backgroundColor=t.color,document.getElementById(t.id).childNodes[3].style.zIndex=t.zIndex):"resize"==t.send_type?t.cookie!=document.cookie&&(document.getElementById(t.id).childNodes[3].style.width=t.width-20+"px",document.getElementById(t.id).childNodes[3].style.height=t.height-4+"px"):"create"==t.send_type?t.cookie!=document.cookie&&d(t.author):"delete"==t.send_type?t.cookie!=document.cookie&&(postIt=document.getElementById(t.id),deletePostIt(postIt)):"save"==t.send_type&&t.cookie==document.cookie&&$("#saveMark").html("Saved ✔")},$(document).on("mousedown",".draggable",function(e){"TEXTAREA"==e.target.nodeName&&(n.width=e.target.style.width,n.height=e.target.style.height)}),$(document).on("click",".draggable",function(e){if("DIV"==e.target.nodeName||"IMG"==e.target.nodeName||"H3"==e.target.nodeName||"BUTTON"==e.target.nodeName){for(var o=e.target.parentElement;!o.classList.contains("draggable");)o=o.parentElement;var d=postItSyncEle(o,"move");return t.send(JSON.stringify(d)),$("#saveMark").html("Changes are not saved ✖"),!1}if("TEXTAREA"==e.target.nodeName&&e.target.style.width!=n.width){d=postItSyncEle(e.target.parentElement,"resize");return t.send(JSON.stringify(d)),$("#saveMark").html("Changes are not saved ✖"),!1}return!1}),o(),$(document).on("click","#saveButton",function(n){var o={},d=[];for(let e of $(".draggable"))d.push(postItSyncEle(e,"save"));return o.content=d,o.send_type="save",o.session_code=e,o.cookie=document.cookie,t.send(JSON.stringify(o)),!1}),$(document).on("click",".deleteButton",function(n){postItToDelete=n.target.parentElement.parentElement.parentElement.parentElement.parentElement;var o=postItSyncEle(postItToDelete,"delete");return o.session_code=e,deletePostIt(postItToDelete),t.send(JSON.stringify(o)),!1}),$(document).on("click","#createButton",function(n){return postAuthor=JSON.parse(document.getElementById("username").textContent),newPostIt=d(postAuthor),message=postItSyncEle(newPostIt,"create"),message.session_code=e,console.log(message),t.send(JSON.stringify(message)),!1})}),Array.from(document.getElementsByClassName("dropdown")).forEach(function(e){e.addEventListener("click",function(e){var t=(e=e||window.event).target||e.srcElement;t.textContent||t.innerText;t.parentElement.classList.toggle("show")})}),window.onclick=function(e){null!=e.target.parentElement&&(e.target.parentElement.classList.contains("dropdown")||e.target.parentElement.classList.contains("dropdowncolor")||e.target.parentElement.classList.contains("dropdownground"))?e.target.parentElement.classList.contains("dropdowncolor")?Array.from(document.getElementsByClassName("dropdown")).forEach(function(e){e.childNodes[2].childNodes[5].childNodes[0].classList.remove("showground"),e.childNodes[2].childNodes[5].childNodes[0].classList.remove("show")}):e.target.parentElement.classList.contains("dropdownground")&&Array.from(document.getElementsByClassName("dropdown")).forEach(function(e){e.childNodes[2].childNodes[3].childNodes[0].classList.remove("showcolor"),e.childNodes[2].childNodes[3].childNodes[0].classList.remove("show")}):Array.from(document.getElementsByClassName("dropdown")).forEach(function(e){e.classList.remove("show"),e.childNodes[2].childNodes[3].childNodes[0].classList.remove("showcolor"),e.childNodes[2].childNodes[3].childNodes[0].classList.remove("show"),e.childNodes[2].childNodes[5].childNodes[0].classList.remove("showground"),e.childNodes[2].childNodes[5].childNodes[0].classList.remove("show")})};